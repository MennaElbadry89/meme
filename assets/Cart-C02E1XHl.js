import{u as P,r as t,a as O,p as R,c as B,S as E,j as e,h as M,L as S}from"./index-CgxueZb7.js";function A(){const l=P(),i=t.useRef(),{currentUser:n,loadingDisplayCurrentUser:d}=t.useContext(O),{placeOrder:f}=t.useContext(R),[N,m]=t.useState(!1),[x,b]=t.useState(!1),{cartIdes:h,records:c,isLoadingRecords:C,errorRecords:u,getProductOfCart:y,handlechangeAmount:v,handelDelete:w,clearCartData:L}=t.useContext(B);console.log(h),console.log(c);const p=c.map(s=>({...s,amount:h[s.id]})),j=p.reduce((s,a)=>{const o=a.price-a.price*a.discount/100;return s+o*a.amount},0),k=async s=>{m(!0);const a=await f(s);a.success?(L(),i.current.click()):b(a.message),m(!1)};return t.useEffect(()=>{y()},[]),t.useEffect(()=>{!n&&!d&&E.fire({title:"Authentication Required",text:"Please login or register to view your cart",icon:"warning",showCancelButton:!0,confirmButtonColor:"#3085d6",cancelButtonColor:"#d33",confirmButtonText:"Register or Login",cancelButtonText:"Cancel"}).then(s=>{s.isConfirmed?l("/register"):l("/")})},[n,d,l]),e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"Cart",children:[e.jsxs("p",{className:"my-5 h1 text-center",children:["Your ",e.jsx("span",{style:{color:"var(--secondry-color)"},children:"Cart"})," "]}),e.jsx("div",{className:"container my-3",children:C?e.jsx(M,{status:"page"}):c.legnth==0?e.jsxs("div",{children:[e.jsx("p",{children:"there is no products here"}),e.jsx(S,{to:"shop",children:"what about going to Shop"})]}):e.jsxs("div",{className:"row gap-1 ",children:[p.map((s,a)=>{const o=Array(s.stock).fill(0).map((g,r)=>(++r,e.jsx("option",{value:r,children:r},r)));return e.jsxs("div",{className:"col-12 flex justify-content-around p-1 rounded bg-white shadow",children:[e.jsx("div",{className:"p-2 rounded",children:e.jsx("img",{src:s.image,style:{width:"75px",height:"75px"},alt:""})}),e.jsx("div",{children:e.jsxs("p",{className:"text-dark",children:["Title : ",s.catogery]})}),e.jsxs("div",{className:"flex gap-5",children:[e.jsxs("p",{className:"m-0 text-dark",children:["Price : $",s.price]}),e.jsxs("p",{className:"m-0 text-dark",children:["TotalPrice : $",(s.price*s.amount).toFixed(2)]})]}),e.jsx("div",{children:e.jsx("select",{onChange:g=>v(s.id,g.target.value),value:s.amount,className:"form-select","aria-label":"Default select example",children:o})}),e.jsx("div",{children:e.jsx("button",{onClick:()=>w(s),className:"btn btn-danger",children:"Remove "})})]},a)}),e.jsx("div",{className:"col-8 offset-2 bg-white rounded my-2 py-2 shadow ",children:e.jsxs("div",{className:"flex flex justify-content-around ",children:[e.jsx("p",{className:"h5 text-primary",children:"Total : "}),e.jsxs("p",{className:"h5 text-primary",children:["$",j.toFixed(2)]})]})}),n&&e.jsx("div",{className:"col-12 mt-3",children:e.jsx("button",{className:"btn btn-dark","data-bs-toggle":"modal","data-bs-target":"#exampleModal2",children:"Place Order"})})]})}),u&&e.jsxs("div",{classNameName:"alert alert-danger",children:[" ",u," "]}),x&&e.jsxs("div",{className:"alert alert-danger",children:[" ",x," "]})]}),e.jsx("div",{className:"modal fade",id:"exampleModal2",tabIndex:"-1","aria-labelledby":"exampleModalLabel","aria-hidden":"true",children:e.jsx("div",{className:"modal-dialog",children:e.jsxs("div",{className:"modal-content",children:[e.jsxs("div",{className:"modal-header",children:[e.jsx("h1",{className:"modal-title fs-5",id:"exampleModalLabel",children:" Place Order"}),e.jsx("button",{type:"button",className:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})]}),e.jsx("div",{className:"modal-body",children:"Are u sure to place orders ?"}),e.jsxs("div",{className:"modal-footer",children:[e.jsx("button",{type:"button",className:"btn btn-secondary","data-bs-dismiss":"modal",ref:i,children:"Cancle"}),e.jsx("button",{onClick:()=>{k(j)},type:"button",className:"btn btn-info",children:N?e.jsxs("div",{children:[e.jsx("div",{className:"spinner border text-light",style:{width:"15px",height:"15px"}}),e.jsx("span",{className:"ms-2 ",children:"  Loading"})]}):"Confirm"})]})]})})})]})}export{A as default};
